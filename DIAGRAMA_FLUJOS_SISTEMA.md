# ğŸ”„ DIAGRAMA DE FLUJOS SISTEMA LPDP

## ğŸ“‹ FLUJO 1: CREACIÃ“N RAT COMPLETA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INICIO CREAR RATâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NO     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Datos empresa  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Cargar datos     â”‚
â”‚ ya ingresados?  â”‚            â”‚ permanentes      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ (Ãºltimo RAT)     â”‚
          â”‚ SÃ                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â–¼                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ PASO 1/6:       â”‚
â”‚ Responsable     â”‚ âœ… DATOS PERMANENTES PRESERVADOS
â”‚ - Empresa       â”‚ âœ… NO VOLVER A PEDIR
â”‚ - DPO           â”‚ âœ… Auto-completado Ãºltimo RAT
â”‚ - Representante â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASO 2/6:       â”‚
â”‚ Finalidades     â”‚ ğŸ†• NUEVA ACTIVIDAD
â”‚ - DescripciÃ³n   â”‚ ğŸ†• NUEVA finalidad  
â”‚ - Base legal    â”‚ ğŸ†• NUEVO argumento jurÃ­dico
â”‚ - Argumento     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASO 3/6:       â”‚
â”‚ CategorÃ­as      â”‚ ğŸ†• NUEVAS categorÃ­as datos
â”‚ - Datos perso.  â”‚ ğŸ†• NUEVOS tipos
â”‚ - Datos sensib. â”‚ ğŸ†• NUEVA selecciÃ³n
â”‚ - Titulares     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASO 4/6:       â”‚
â”‚ ConservaciÃ³n    â”‚ ğŸ†• NUEVO perÃ­odo
â”‚ - PerÃ­odo       â”‚ ğŸ†• NUEVO criterio
â”‚ - Criterio      â”‚ ğŸ†• NUEVA justificaciÃ³n
â”‚ - JustificaciÃ³n â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASO 5/6:       â”‚
â”‚ Transferencias  â”‚ ğŸ†• NUEVAS transferencias
â”‚ - Internaciona. â”‚ ğŸ†• NUEVOS paÃ­ses
â”‚ - PaÃ­ses        â”‚ ğŸ†• NUEVAS garantÃ­as
â”‚ - GarantÃ­as     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASO 6/6:       â”‚
â”‚ Medidas Segur.  â”‚ ğŸ†• NUEVAS medidas tÃ©cnicas
â”‚ - TÃ©cnicas      â”‚ ğŸ†• NUEVAS medidas organiz.
â”‚ - Organizativas â”‚ ğŸ†• NUEVA descripciÃ³n
â”‚ - DescripciÃ³n   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GUARDAR RAT     â”‚
â”‚ â†“               â”‚
â”‚ Mapeo_datos_rat â”‚ âœ… PERSISTENCIA SUPABASE
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERAR EIPD    â”‚ âœ… AUTOMÃTICO AL CREAR RAT
â”‚ AUTOMÃTICA      â”‚ âœ… NO al aprobar DPO
â”‚ (si requiere)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ASIGNAR TAREA   â”‚ âœ… DPO recibe notificaciÃ³n
â”‚ DPO             â”‚ âœ… Cola aprobaciÃ³n automÃ¡tica
â”‚ (automÃ¡tica)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FIN - RAT       â”‚ âœ… RAT creado con ID Ãºnico
â”‚ CREADO          â”‚ âœ… Visible en lista RATs
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ FLUJO 2: EDICIÃ“N RAT EXISTENTE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ABRIR EDICIÃ“N   â”‚
â”‚ RAT (ID: XXX)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CARGAR RAT      â”‚ âœ… Mostrar ID en tÃ­tulo
â”‚ POR ID          â”‚ âœ… Panel informaciÃ³n visible
â”‚                 â”‚ âœ… Estado: EN EDICIÃ“N
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MODO EDICIÃ“N    â”‚ â—„â”€â”€ â”‚ BotÃ³n            â”‚
â”‚ Stepper 6 pasos â”‚     â”‚ "Ver Completo"   â”‚ âœ… AGREGADO
â”‚ â† Anterior      â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Siguiente â†’     â”‚ âœ… NAVEGACIÃ“N AGREGADA
â”‚ Progreso: X/6   â”‚ âœ… INDICADOR PROGRESO
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GUARDAR CAMBIOS â”‚ âœ… ActualizaciÃ³n BD
â”‚ â†“               â”‚ âœ… Timestamp updated
â”‚ Update RAT      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VOLVER A LISTA  â”‚ âœ… NavegaciÃ³n correcta
â”‚ RATs            â”‚ âœ… Estado actualizado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ FLUJO 3: VALIDACIÃ“N PALETA COLORES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPONENTE UI   â”‚
â”‚ Se renderiza    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NO     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿bgcolor claro  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Renderizar       â”‚
â”‚ + texto claro?  â”‚            â”‚ normalmente      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ SÃ
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ IA DETECTA:  â”‚ ğŸ›¡ï¸ PREVENCIÃ“N AUTOMÃTICA
â”‚ CombinaciÃ³n     â”‚ ğŸ›¡ï¸ Regla activa
â”‚ ilegible        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ AUTO-FIX:    â”‚ 
â”‚ bgcolor:"#1e293b"â”‚ âœ… Fondo oscuro
â”‚ color:"#f1f5f9"  â”‚ âœ… Texto claro
â”‚ secondary:"#94a3"â”‚ âœ… Secondary legible
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… UI LEGIBLE   â”‚ âœ… Contraste adecuado
â”‚ Tema consistenteâ”‚ âœ… Paleta respetada
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—‚ï¸ FLUJO 4: PERSISTENCIA DATOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OPERACIÃ“N BD    â”‚
â”‚ (create/update) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NO     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Tabla existe?  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ âŒ ERROR:        â”‚
â”‚ mapeo_datos_rat â”‚            â”‚ Tabla no existe  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ SÃ
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NO     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿RLS activo?    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ âŒ ERROR:        â”‚
â”‚ Seguridad OK    â”‚            â”‚ Sin permisos     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ SÃ
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDAR DATOS   â”‚ âœ… 8 campos Art.12
â”‚ Art.12 Ley      â”‚ âœ… Estructura vÃ¡lida
â”‚ 21.719          â”‚ âœ… Tipos correctos
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EJECUTAR        â”‚ âœ… INSERT/UPDATE exitoso
â”‚ OPERACIÃ“N       â”‚ âœ… ID generado/preservado
â”‚ SUPABASE        â”‚ âœ… Timestamp actualizado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDAR RESULT  â”‚ âœ… Dato persiste en BD
â”‚ IA verifica     â”‚ âœ… Consulta posterior OK
â”‚ persistencia    â”‚ âœ… Integridad mantenida
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ FLUJO 5: WORKFLOW DPO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAT GUARDADO    â”‚
â”‚ ID: XXX         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     NO     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Requiere EIPD? â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Notificar DPO    â”‚
â”‚ Riesgo > medio  â”‚            â”‚ RAT listo        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ SÃ
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERAR EIPD    â”‚ âœ… AUTOMÃTICO
â”‚ AUTOMÃTICA      â”‚ âœ… Plantilla adecuada
â”‚ Timing: CREAR   â”‚ âœ… NOT en aprobaciÃ³n DPO
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CREAR TAREA DPO â”‚ âœ… Auto-asignaciÃ³n
â”‚ Tabla:          â”‚ âœ… Prioridad: alta/media/baja
â”‚ actividades_dpo â”‚ âœ… Estado: pendiente
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DPO RECIBE      â”‚ âœ… Cola aprobaciÃ³n
â”‚ NOTIFICACIÃ“N    â”‚ âœ… Email automÃ¡tico
â”‚                 â”‚ âœ… Dashboard actualizado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DPO REVISA      â”‚ âš™ï¸ Proceso manual DPO
â”‚ Y APRUEBA       â”‚ âš™ï¸ Comentarios/cambios
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAT APROBADO    â”‚ âœ… Estado: APROBADO
â”‚ Sistema listo   â”‚ âœ… Compliance OK
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” FLUJO 6: VALIDACIÃ“N IA INTELIGENTE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCIÃ“N USUARIO  â”‚
â”‚ (cualquier)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IA INTERCEPTA   â”‚ ğŸ¤– Monitoreo 30seg
â”‚ validateBefore  â”‚ ğŸ¤– Reglas prevenciÃ³n
â”‚ Action()        â”‚ ğŸ¤– Patrones aprendidos
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     SÃ     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Detecta error  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ ğŸš« BLOQUEAR      â”‚
â”‚ potencial?      â”‚            â”‚ Mostrar razÃ³n    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ Sugerir soluciÃ³n â”‚
          â”‚ NO                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… PERMITIR     â”‚ âœ… AcciÃ³n ejecutada
â”‚ ACCIÃ“N          â”‚ âœ… ValidaciÃ³n post-acciÃ³n
â”‚                 â”‚ âœ… Log resultado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APRENDER        â”‚ ğŸ§  Guardar patrÃ³n
â”‚ Resultado â†’     â”‚ ğŸ§  Ajustar confianza
â”‚ Patrones IA     â”‚ ğŸ§  Mejorar prevenciÃ³n
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ FLUJO 7: DATOS PERMANENTES vs ACTIVIDAD

```
DATOS PERMANENTES (NO CAMBIAR):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¢ EMPRESA      â”‚ â† Preservar siempre
â”‚ - RazÃ³n social  â”‚ â† NO volver a pedir
â”‚ - RUT           â”‚ â† Auto-completar
â”‚ - DirecciÃ³n     â”‚ â† Desde Ãºltimo RAT
â”‚ - TelÃ©fono      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ DPO          â”‚ â† Preservar siempre  
â”‚ - Nombre        â”‚ â† NO volver a pedir
â”‚ - Email         â”‚ â† Auto-completar
â”‚ - TelÃ©fono      â”‚ â† Desde Ãºltimo RAT
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DATOS ACTIVIDAD (SIEMPRE NUEVOS):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ACTIVIDAD    â”‚ â† Siempre en blanco
â”‚ - Nombre        â”‚ â† NUEVA actividad
â”‚ - Finalidad     â”‚ â† NUEVA finalidad
â”‚ - Base legal    â”‚ â† NUEVA selecciÃ³n
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š CATEGORÃAS   â”‚ â† Siempre en blanco
â”‚ - Tipos datos   â”‚ â† NUEVA selecciÃ³n
â”‚ - Datos sensib. â”‚ â† NUEVA evaluaciÃ³n
â”‚ - Titulares     â”‚ â† NUEVOS titulares
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš ï¸ FLUJO 8: IDENTIFICACIÃ“N PROBLEMAS

```
PROBLEMA DETECTADO:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario reporta â”‚
â”‚ "datos permanen â”‚
â”‚ te se vuelven   â”‚
â”‚ a pedir"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” IA ANALIZA:  â”‚
â”‚ cargarDatos     â”‚ â† FunciÃ³n problemÃ¡tica
â”‚ Comunes()       â”‚ â† useEffect se ejecuta
â”‚                 â”‚ â† Sin validaciÃ³n previa
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… SOLUCIÃ“N:    â”‚
â”‚ Agregar check   â”‚ â† if (datosYaIngresados)
â”‚ datosYaIngresd  â”‚ â† return; // NO CARGAR
â”‚                 â”‚ â† Prevenir sobrescritura
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§  IA APRENDE:  â”‚ âœ… PatrÃ³n guardado
â”‚ Nuevo patrÃ³n    â”‚ âœ… Regla prevenciÃ³n
â”‚ "DATA_OVERRIDE" â”‚ âœ… Confianza: 1.0
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š FLUJO 9: VALIDACIÃ“N PERSISTENCIA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ANTES OPERACIÃ“N â”‚
â”‚ Validar tabla   â”‚ â† validateTableExists()
â”‚ mapeo_datos_rat â”‚ â† Error 42P01 prevention
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DURANTE OPER.   â”‚ â† INSERT/UPDATE data
â”‚ Ejecutar query  â”‚ â† RLS verificado
â”‚ + Log operaciÃ³n â”‚ â† Audit trail
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DESPUÃ‰S OPER.   â”‚ â† SELECT para verificar
â”‚ Validar result  â”‚ â† Dato existe en BD
â”‚ + IA confirma   â”‚ â† Integridad OK
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… PERSISTENCIA â”‚ âœ… Datos confirmados
â”‚ CONFIRMADA      â”‚ âœ… IA valida Ã©xito
â”‚                 â”‚ âœ… Usuario informado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ PUNTOS CRÃTICOS IDENTIFICADOS:

### âŒ PROBLEMA 1: Datos permanentes se vuelven a pedir
**Causa:** `cargarDatosComunes()` se ejecuta sin validar datos existentes  
**SoluciÃ³n:** âœ… Agregado check `datosYaIngresados` antes de cargar  
**IA Regla:** `PRESERVE_USER_INPUT_DATA`

### âŒ PROBLEMA 2: EIPD timing incorrecto
**Causa:** EIPD se generaba en aprobaciÃ³n DPO, no en creaciÃ³n RAT  
**SoluciÃ³n:** âœ… `timing: 'RAT_CREATION_TIME'` configurado  
**IA Regla:** `EIPD_GENERATE_ON_RAT_CREATE`

### âŒ PROBLEMA 3: UI ilegible paleta colores
**Causa:** `bgcolor: '#f8fafc'` + `color: 'text.secondary'` = blanco+blanco  
**SoluciÃ³n:** âœ… `bgcolor: '#1e293b'` + `color: '#f1f5f9'`  
**IA Regla:** `NEVER_WHITE_BACKGROUND_WHITE_TEXT`

### âŒ PROBLEMA 4: Falta navegaciÃ³n formularios
**Causa:** Stepper sin botones Anterior/Siguiente  
**SoluciÃ³n:** âœ… Botones + indicador progreso agregados  
**IA Regla:** `REQUIRE_NAVIGATION_BUTTONS_IN_FORMS`

---

**Estado IA:** ğŸ¤– **INTELIGENCIA MEJORADA ACTIVA**  
**Reglas prevenciÃ³n:** 8 activas  
**Patrones aprendizaje:** 12 registrados  
**Auto-fix:** âœ… Habilitado  
**Monitoreo:** â±ï¸ Cada 30 segundos